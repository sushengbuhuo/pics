'use strict';var _data={weisuoyuwei:[{range:[10,14],text:'\u597D\u554A'},{range:[26,37],text:'\u6211\u662F\u4E00\u7B49\u826F\u6C11\u5C31\u4E0D\u8BF4\u4E86'},{range:[43,61],text:'\u5373\u4F7F\u4E00\u5B9A\u8981\u51A4\u6789\u6211'},{range:[61,81],text:'\u6211\u4E5F\u6709\u94B1\u8058\u5927\u5F8B\u5E08\u5E2E\u6211'},{range:[81,93],text:'\u6211\u770B\u6211\u522B\u6307\u671B\u5750\u7262\u4E86'},{range:[96,105],text:'\u4F60\u522B\u4EE5\u4E3A\u6709\u94B1\u5C31\u80FD\u4E3A\u6240\u6B32\u4E3A'},{range:[111,131],text:'\u62B1\u6B49\uFF0C\u6709\u94B1\u662F\u771F\u7684\u80FD\u4E3A\u6240\u6B32\u4E3A\u7684'},{range:[145,157],text:'\u4F46\u6211\u770B\u4ED6\u9886\u4F1A\u4E0D\u5230\u8FD9\u79CD\u610F\u5883'},{range:[157,166],text:'\u9886\u4F1A\u4E0D\u5230'}],wangjingzei:[{range:[0,10],text:'\u6211\u5C31\u662F\u997F\u6B7B'},{range:[12,24],text:'\u6B7B\u5916\u8FB9 \u4ECE\u8FD9\u8DF3\u4E0B\u53BB'},{range:[25,35],text:'\u4E5F\u4E0D\u4F1A\u5403\u4F60\u4EEC\u4E00\u70B9\u4E1C\u897F'},{range:[37,49],text:'\u771F\u9999'}],qiegewala:[{range:[0,15],text:'\u6CA1\u6709\u94B1\u554A \u80AF\u5B9A\u8981\u505A\u7684\u554A'},{range:[15,30],text:'\u4E0D\u505A\u7684\u8BDD\u6CA1\u6709\u94B1\u7528'},{range:[31,38],text:'\u90A3\u4F60\u4E0D\u4F1A\u53BB\u6253\u5DE5\u554A'},{range:[38,48],text:'\u6709\u624B\u6709\u811A\u7684'},{range:[48,68],text:'\u6253\u5DE5\u662F\u4E0D\u53EF\u80FD\u6253\u5DE5\u7684'},{range:[68,86],text:'\u8FD9\u8F88\u5B50\u4E0D\u53EF\u80FD\u6253\u5DE5\u7684'}]},app=new Vue({el:'#app',data:function data(){return{open:!1,titles:[{name:'\u6709\u94B1\u5C31\u662F\u4E3A\u6240\u6B32\u4E3A',url:'weisuoyuwei'},{name:'\u738B\u5883\u6CFD',url:'wangjingzei'},{name:'\u7A83\u683C\u74E6\u62C9',url:'qiegewala'}],hints:_data.weisuoyuwei,img:{osrc:'./static/img/weisuoyuwei.gif',src:'./static/img/weisuoyuwei.gif'},progress:{seen:!1,value:0},button:{disabled:!1}}},methods:{toggle:function toggle(b){this.open=!this.open,this.docked=!b},genGif:function genGif(){this.button.disabled=!0,this.progress.seen=!0,this.progress.value=0,getGIFFrames(this.img.osrc)},download:function download(){var b=document.createElement('a');document.body.appendChild(b),b.style='display: none',b.href=this.img.src,b.download=this.img.src.slice(-8)+'.gif',b.click(),window.URL.revokeObjectURL(this.img.src)},change:function change(b){this.hints=_data[b],this.img.osrc='./static/img/'+b+'.gif',this.img.src='./static/img/'+b+'.gif'}}}),getGIFFrames=function(b){var c=new XMLHttpRequest;c.open('GET',b,!0),c.responseType='arraybuffer',c.onload=function(){app.progress.value+=5;var e=c.response;if(e){var f=new DGIF(e),g=f.decompressFrames(!0),h=document.getElementById('source'),k=document.createElement('canvas'),l=k.getContext('2d'),m=document.createElement('canvas');m.width=h.width,m.height=h.height;var n=m.getContext('2d'),o=m.cloneNode(!0),p=o.getContext('2d'),q=new GIF({workers:2,quality:20,workerScript:'./static/js/gif.worker.js'});app.progress.value+=5;var r=app.hints,s=g.length,t=!1;setCtx(n,'18px Microsoft YaHei');for(var w,u=0,v=0;u<s;u++){if(w=g[u],drawPatch(w,k,l,n,p),t){t=!1,n.drawImage(o,0,0);continue}v<r.length&&u>=r[v].range[0]&&u<r[v].range[1]&&(subFrame(n,m.width,r[v].text,0.9*m.height),u+1===r[v].range[1]&&(t=!0,v++)),q.addFrame(m,{delay:w.delay,copy:!0}),app.progress.value+=80/s}q.on('finished',function(x){console.log('finish'),app.progress.value=100,app.button.disabled=!1,app.img.src=URL.createObjectURL(x),app.progress.seen=!1}),q.render()}},c.send(null)},setCtx=function(b,c){b.textAlign='center',b.fillStyle='white',b.strokeStyle='black',b.lineWidth=2,b.font=c},drawPatch=function(b,c,d,e,f){var h,g=b.dims;h&&g.width==h.width&&g.height==h.height||(c.width=g.width,c.height=g.height,h=d.createImageData(g.width,g.height)),h.data.set(b.patch),d.putImageData(h,0,0),e.drawImage(c,g.left,g.top),f.drawImage(c,g.left,g.top)},subFrame=function(b,c,d,e){b.strokeText(d,c/2,e),b.fillText(d,c/2,e)};